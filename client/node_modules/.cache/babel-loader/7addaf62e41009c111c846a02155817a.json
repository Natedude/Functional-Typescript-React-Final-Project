{"ast":null,"code":"import { isAudioBufferSourceNode } from '../guards/audio-buffer-source-node';\nimport { isAudioWorkletNode } from '../guards/audio-worklet-node';\nimport { isBiquadFilterNode } from '../guards/biquad-filter-node';\nimport { isConstantSourceNode } from '../guards/constant-source-node';\nimport { isGainNode } from '../guards/gain-node';\nimport { isOscillatorNode } from '../guards/oscillator-node';\nimport { isStereoPannerNode } from '../guards/stereo-panner-node';\nimport { getAudioNodeConnections } from './get-audio-node-connections';\nimport { getAudioParamConnections } from './get-audio-param-connections';\nimport { isActiveAudioNode } from './is-active-audio-node';\nimport { setInternalStateToPassive } from './set-internal-state-to-passive';\nexport const deactivateActiveAudioNodeInputConnections = (audioNode, trace) => {\n  const {\n    activeInputs\n  } = getAudioNodeConnections(audioNode);\n  activeInputs.forEach(connections => connections.forEach(([source]) => {\n    if (!trace.includes(audioNode)) {\n      deactivateActiveAudioNodeInputConnections(source, [...trace, audioNode]);\n    }\n  }));\n  const audioParams = isAudioBufferSourceNode(audioNode) ? [// Bug #149: Safari does not yet support the detune AudioParam.\n  audioNode.playbackRate] : isAudioWorkletNode(audioNode) ? Array.from(audioNode.parameters.values()) : isBiquadFilterNode(audioNode) ? [audioNode.Q, audioNode.detune, audioNode.frequency, audioNode.gain] : isConstantSourceNode(audioNode) ? [audioNode.offset] : isGainNode(audioNode) ? [audioNode.gain] : isOscillatorNode(audioNode) ? [audioNode.detune, audioNode.frequency] : isStereoPannerNode(audioNode) ? [audioNode.pan] : [];\n\n  for (const audioParam of audioParams) {\n    const audioParamConnections = getAudioParamConnections(audioParam);\n\n    if (audioParamConnections !== undefined) {\n      audioParamConnections.activeInputs.forEach(([source]) => deactivateActiveAudioNodeInputConnections(source, trace));\n    }\n  }\n\n  if (isActiveAudioNode(audioNode)) {\n    setInternalStateToPassive(audioNode);\n  }\n};","map":{"version":3,"sources":["../../../src/helpers/deactivate-active-audio-node-input-connections.ts"],"names":[],"mappings":"AAAA,SAAS,uBAAT,QAAwC,oCAAxC;AACA,SAAS,kBAAT,QAAmC,8BAAnC;AACA,SAAS,kBAAT,QAAmC,8BAAnC;AACA,SAAS,oBAAT,QAAqC,gCAArC;AACA,SAAS,UAAT,QAA2B,qBAA3B;AACA,SAAS,gBAAT,QAAiC,2BAAjC;AACA,SAAS,kBAAT,QAAmC,8BAAnC;AAGA,SAAS,uBAAT,QAAwC,8BAAxC;AACA,SAAS,wBAAT,QAAyC,+BAAzC;AACA,SAAS,iBAAT,QAAkC,wBAAlC;AACA,SAAS,yBAAT,QAA0C,iCAA1C;AAEA,OAAO,MAAM,yCAAyC,GAAG,CACrD,SADqD,EAErD,KAFqD,KAGrD;AACA,QAAM;AAAE,IAAA;AAAF,MAAmB,uBAAuB,CAAC,SAAD,CAAhD;AAEA,EAAA,YAAY,CAAC,OAAb,CAAsB,WAAD,IACjB,WAAW,CAAC,OAAZ,CAAoB,CAAC,CAAC,MAAD,CAAD,KAAa;AAC7B,QAAI,CAAC,KAAK,CAAC,QAAN,CAAe,SAAf,CAAL,EAAgC;AAC5B,MAAA,yCAAyC,CAAC,MAAD,EAAS,CAAC,GAAG,KAAJ,EAAW,SAAX,CAAT,CAAzC;AACH;AACJ,GAJD,CADJ;AAQA,QAAM,WAAW,GAAG,uBAAuB,CAAC,SAAD,CAAvB,GACd,CACI;AACA,EAAA,SAAS,CAAC,YAFd,CADc,GAKd,kBAAkB,CAAC,SAAD,CAAlB,GACA,KAAK,CAAC,IAAN,CAAW,SAAS,CAAC,UAAV,CAAqB,MAArB,EAAX,CADA,GAEA,kBAAkB,CAAC,SAAD,CAAlB,GACA,CAAC,SAAS,CAAC,CAAX,EAAc,SAAS,CAAC,MAAxB,EAAgC,SAAS,CAAC,SAA1C,EAAqD,SAAS,CAAC,IAA/D,CADA,GAEA,oBAAoB,CAAC,SAAD,CAApB,GACA,CAAC,SAAS,CAAC,MAAX,CADA,GAEA,UAAU,CAAC,SAAD,CAAV,GACA,CAAC,SAAS,CAAC,IAAX,CADA,GAEA,gBAAgB,CAAC,SAAD,CAAhB,GACA,CAAC,SAAS,CAAC,MAAX,EAAmB,SAAS,CAAC,SAA7B,CADA,GAEA,kBAAkB,CAAC,SAAD,CAAlB,GACA,CAAC,SAAS,CAAC,GAAX,CADA,GAEA,EAjBN;;AAmBA,OAAK,MAAM,UAAX,IAAyB,WAAzB,EAAsC;AAClC,UAAM,qBAAqB,GAAG,wBAAwB,CAAI,UAAJ,CAAtD;;AAEA,QAAI,qBAAqB,KAAK,SAA9B,EAAyC;AACrC,MAAA,qBAAqB,CAAC,YAAtB,CAAmC,OAAnC,CAA2C,CAAC,CAAC,MAAD,CAAD,KAAc,yCAAyC,CAAC,MAAD,EAAS,KAAT,CAAlG;AACH;AACJ;;AAED,MAAI,iBAAiB,CAAC,SAAD,CAArB,EAAkC;AAC9B,IAAA,yBAAyB,CAAC,SAAD,CAAzB;AACH;AACJ,CA5CM","sourceRoot":"","sourcesContent":["import { isAudioBufferSourceNode } from '../guards/audio-buffer-source-node';\nimport { isAudioWorkletNode } from '../guards/audio-worklet-node';\nimport { isBiquadFilterNode } from '../guards/biquad-filter-node';\nimport { isConstantSourceNode } from '../guards/constant-source-node';\nimport { isGainNode } from '../guards/gain-node';\nimport { isOscillatorNode } from '../guards/oscillator-node';\nimport { isStereoPannerNode } from '../guards/stereo-panner-node';\nimport { getAudioNodeConnections } from './get-audio-node-connections';\nimport { getAudioParamConnections } from './get-audio-param-connections';\nimport { isActiveAudioNode } from './is-active-audio-node';\nimport { setInternalStateToPassive } from './set-internal-state-to-passive';\nexport const deactivateActiveAudioNodeInputConnections = (audioNode, trace) => {\n    const { activeInputs } = getAudioNodeConnections(audioNode);\n    activeInputs.forEach((connections) => connections.forEach(([source]) => {\n        if (!trace.includes(audioNode)) {\n            deactivateActiveAudioNodeInputConnections(source, [...trace, audioNode]);\n        }\n    }));\n    const audioParams = isAudioBufferSourceNode(audioNode)\n        ? [\n            // Bug #149: Safari does not yet support the detune AudioParam.\n            audioNode.playbackRate\n        ]\n        : isAudioWorkletNode(audioNode)\n            ? Array.from(audioNode.parameters.values())\n            : isBiquadFilterNode(audioNode)\n                ? [audioNode.Q, audioNode.detune, audioNode.frequency, audioNode.gain]\n                : isConstantSourceNode(audioNode)\n                    ? [audioNode.offset]\n                    : isGainNode(audioNode)\n                        ? [audioNode.gain]\n                        : isOscillatorNode(audioNode)\n                            ? [audioNode.detune, audioNode.frequency]\n                            : isStereoPannerNode(audioNode)\n                                ? [audioNode.pan]\n                                : [];\n    for (const audioParam of audioParams) {\n        const audioParamConnections = getAudioParamConnections(audioParam);\n        if (audioParamConnections !== undefined) {\n            audioParamConnections.activeInputs.forEach(([source]) => deactivateActiveAudioNodeInputConnections(source, trace));\n        }\n    }\n    if (isActiveAudioNode(audioNode)) {\n        setInternalStateToPassive(audioNode);\n    }\n};\n//# sourceMappingURL=deactivate-active-audio-node-input-connections.js.map"]},"metadata":{},"sourceType":"module"}